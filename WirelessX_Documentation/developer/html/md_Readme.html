<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: WIRELESS X</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">WIRELESS X </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Installation Setup</h1>
<pre class="fragment">1. (Optional if already present) Install below packages (python development):

        $ sudo apt-get install python3-tk python3-dev


2. Install opencv, autopy, pynput, pyfakewebcam library:

        $ sudo pip3 install opencv-python
        $ sudo pip3 install autopy
        $ sudo pip3 install pynput
        $ sudo pip3 install pyfakewebcam


3. FFmpeg and v4l2loopback Setup (for virtual device creation and video frames rendering):

    a. Install FFmpeg by typing following command:

            $ sudo apt install ffmpeg


    b. Install v4l2loopback-dkms v4l2loopback-utils module:

            $ sudo apt install v4l2loopback-dkms v4l2loopback-utils
            $ sudo modprobe -r v4l2loopback
            $ sudo depmod -a
</pre><h1><a class="anchor" id="autotoc_md2"></a>
Running the application (Strictly follow the below order inorder to run it successfully):</h1>
<pre class="fragment">1. Creating virtual device (for webcam) and server On Desktop / Laptop side:

    a. Create device using below 2 commands:
            $ sudo modprobe v4l2loopback devices=1 video_nr=20 card_label='Wireless-X Camera' exclusive_caps=1


        Check if your virtual device is created
            $ ls /dev | grep -P '^video\d+$'

        (Optional if already done earlier):
            $ sudo depmod -a


    b. run python file in the directory using below command:
            $ python3 Wireless-X_server.py

        If no errors encountered, below output should be displayed on terminal:

                ---------Wireless-X Server------
                Camera stream port: 9998
                Keyboard and Mouse Listening port: 6666



2. Application Installation and Setup on Android Smartphone:

    a. Install the Wireless-X apk on Android smartphone and give required permissions.

    b. Now enter the IP address of the Laptop/ Desktop on which the server is hosted. You can type the below command in terminal to get host IP:
            $ ifconfig 

    c. Click on Test Button to test the connection of smartphone with the server. If failed, Recheck if you have entered correct IP address of Laptop/ Desktop (on 
        which the server is running).

    d. After successfull connection, you would be able to control mouse, keyboard of laptop and use smartphones camera as webcam for the laptop/Desktop.

    e. Now you would be able to use this virtual webcam device on chrome for video conferincing. (Tested on chrome for MS Teams and Google Meet).

    f. (Optional) Inorder to test if camera frames are received to the Laptop/ Desktop, use the below command while (Note: camera option should be turned on in the 
        Wireless-X apk on Android):
            $ ffplay /dev/video20 
</pre><h1><a class="anchor" id="autotoc_md3"></a>
IMPORTANT: Make sure you have a virtual device created before running the Wireless-X_server.py.</h1>
<h3><a class="anchor" id="autotoc_md4"></a>
*Extra (Inorder to remove v42loopback devices, use below command):</h3>
<pre class="fragment">        $ sudo modprobe -r v4l2loopback
</pre><h1><a class="anchor" id="autotoc_md5"></a>
Steps for Debugging (If python code doesn't run after above commands):</h1>
<pre class="fragment">1. Check if your virtual device is created

    $ ls /dev | grep -P '^video\d+$'
    OR
    $ v4l2-ctl --list-devices    # TO List the virtual devices in detail

        Output should look somewhat like this:

            Wireless-X Camera (platform:v4l2loopback-000):
                /dev/video20

            Webcam C170: Webcam C170 (usb-0000:00:1a.0-1.2):
                /dev/video0
                /dev/video1


2. Inorder to test if virtual device is working:
    Copy the sample code from  https://github.com/jremmons/pyfakewebcam page and save it as python file and run it.

        $ python3 demo.py

    If everything worked correctly, no error should be displayed and terminal should be blank.
    Now, Open another terminal and test if virtual device output is being display by entering below command:

        $ ffplay /dev/video20

    Note: ffplay
</pre><p>#References</p>
<p>Opencv references: </p><pre class="fragment">https://cmsdk.com/java/android-opencv-tcp-video-streaming.html
</pre><p>v4l2loopback references: </p><pre class="fragment">https://github.com/jremmons/pyfakewebcam
https://github.com/jremmons/pyfakewebcam/issues/5
https://github.com/umlaeute/v4l2loopback#DKMS
</pre><p>Android: <a href="https://stackoverflow.com/questions/23024831/android-shared-preferences-for-creating-one-time-activity-example">https://stackoverflow.com/questions/23024831/android-shared-preferences-for-creating-one-time-activity-example</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
